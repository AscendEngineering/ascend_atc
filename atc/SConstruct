import subprocess

protoc_source = "messaging/definitions"
protoc_dest = "messaging/libs"
env = Environment() 

#create proto files
subprocess.check_call("protoc -I=messaging/definitions --cpp_out=messaging/libs messaging/definitions/status.proto", shell=True)

#messaging
messaging_files = Glob('messaging/libs/*.cc')
messaging_files.extend(['drone_msg.cpp','ascend_zmq.cpp'])


#constants
constant_files = ['constants.h']

env=Environment(
    CPPDEFINES=[],
    CCFLAGS=['-g'],
    LIBS=['zmq', 'pqxx' ,'pq','protobuf'],
	LIBPATH=['third_party/libpqxx-6.4.5/include',
            'third_party/zeromq-4.3.2/include'],
    SCONS_CXX_STANDARD='c++14')

env.Program('atc', ['main.cpp','ascenddb.cpp','ledger.cpp',messaging_files,constant_files])
env.Program('drone', ['drone_main.cpp',messaging_files,constant_files])
env.Program('worker', ['worker_main.cpp',messaging_files,constant_files])
